{
  "analysis_metadata": {
    "date": "2025-11-19",
    "source_policy": "policies/stratusscan-required-permissions.json",
    "govcloud_regions": ["us-gov-west-1", "us-gov-east-1"],
    "documentation_sources": [
      "https://docs.aws.amazon.com/govcloud-us/latest/UserGuide/using-services.html",
      "AWS GovCloud Regional Availability API",
      "AWS GovCloud Documentation (November 2024 - January 2025)"
    ]
  },

  "govcloud_available": [
    "ec2",
    "autoscaling",
    "ecs",
    "eks",
    "elasticbeanstalk",
    "lambda",
    "s3",
    "glacier",
    "elasticfilesystem",
    "fsx",
    "backup",
    "storagegateway",
    "rds",
    "dynamodb",
    "elasticache",
    "redshift",
    "memorydb",
    "elasticloadbalancing",
    "route53",
    "route53resolver",
    "directconnect",
    "networkmanager",
    "network-firewall",
    "iam",
    "sts",
    "kms",
    "secretsmanager",
    "acm",
    "acm-pca",
    "wafv2",
    "shield",
    "guardduty",
    "cloudtrail",
    "config",
    "access-analyzer",
    "detective",
    "macie2",
    "cloudwatch",
    "logs",
    "xray",
    "apigateway",
    "appsync",
    "apprunner",
    "cognito-idp",
    "cognito-identity",
    "sns",
    "sqs",
    "events",
    "states",
    "codecommit",
    "codebuild",
    "codedeploy",
    "codepipeline",
    "glue",
    "athena",
    "lakeformation",
    "es",
    "sagemaker",
    "bedrock",
    "comprehend",
    "rekognition",
    "cloudformation",
    "ssm",
    "servicecatalog",
    "servicediscovery",
    "imagebuilder",
    "datasync",
    "transfer",
    "connect",
    "ses",
    "mobiletargeting",
    "license-manager",
    "aws-marketplace",
    "organizations",
    "verifiedpermissions",
    "rolesanywhere"
  ],

  "govcloud_limited": [
    {
      "service": "cloudfront",
      "status": "not_in_region_but_usable",
      "limitations": "CloudFront is NOT available within GovCloud regions but CAN be used with GovCloud resources as an origin. CloudFront exists outside the GovCloud boundary and should NOT be used for ITAR-controlled data. Status: Being Planned for GovCloud regions.",
      "workaround": "Can be configured to use GovCloud S3/ELB as origin servers, but CloudFront itself runs in commercial regions"
    },
    {
      "service": "globalaccelerator",
      "status": "not_expanding_to_govcloud",
      "limitations": "AWS Global Accelerator is NOT available in GovCloud and is not expanding to GovCloud regions. This is a global service that operates outside GovCloud boundaries.",
      "workaround": "Use Route53 with health checks and latency-based routing as alternative"
    },
    {
      "service": "s3",
      "limitations": "S3 Transfer Acceleration, S3 Storage Lens, S3 Express One Zone, S3 Tables, S3 Metadata, and MFA Delete are NOT available in GovCloud. Multi-Region Access Points have limited functionality."
    },
    {
      "service": "cloudwatch",
      "limitations": "Transaction Search, GetMetricWidgetImage API, dashboard sharing, Trusted Advisor metrics alarms, and cross-account observability are NOT available in GovCloud."
    },
    {
      "service": "aws-marketplace",
      "limitations": "Full catalog not available. Container products and ML products not supported. Cannot launch from AWS Marketplace website with GovCloud account. No Service Catalog integration."
    },
    {
      "service": "support",
      "limitations": "AWS Trusted Advisor has limited checks in GovCloud. Cannot change severity of existing support cases. Partner-Led Support available but without Diagnostic Tools."
    }
  ],

  "govcloud_unavailable": [],

  "required_services": [
    "ec2",
    "autoscaling",
    "ecs",
    "eks",
    "elasticbeanstalk",
    "lambda",
    "s3",
    "elasticfilesystem",
    "fsx",
    "backup",
    "storagegateway",
    "glacier",
    "rds",
    "dynamodb",
    "elasticache",
    "redshift",
    "memorydb",
    "elasticloadbalancing",
    "route53",
    "route53resolver",
    "directconnect",
    "networkmanager",
    "network-firewall",
    "iam",
    "sts",
    "organizations",
    "kms",
    "secretsmanager",
    "acm",
    "acm-pca",
    "wafv2",
    "shield",
    "guardduty",
    "cloudtrail",
    "config",
    "access-analyzer",
    "detective",
    "macie2",
    "cloudwatch",
    "logs",
    "xray",
    "apigateway",
    "appsync",
    "apprunner",
    "cognito-idp",
    "cognito-identity",
    "sns",
    "sqs",
    "events",
    "states",
    "codecommit",
    "codebuild",
    "codedeploy",
    "codepipeline",
    "glue",
    "athena",
    "lakeformation",
    "es",
    "cloudformation",
    "ssm",
    "servicecatalog",
    "servicediscovery",
    "imagebuilder",
    "datasync",
    "transfer",
    "connect",
    "ses",
    "license-manager",
    "verifiedpermissions",
    "rolesanywhere"
  ],

  "optional_services": [
    "sagemaker",
    "bedrock",
    "comprehend",
    "rekognition",
    "cloudfront",
    "globalaccelerator",
    "mobiletargeting",
    "aws-marketplace"
  ],

  "service_mapping": {
    "ec2": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["ec2-export.py", "ec2-dedicated-hosts-export.py", "ec2-capacity-reservations-export.py", "ami-export.py", "ebs-volumes-export.py", "ebs-snapshots-export.py"],
      "notes": "Fully supported. Some instance types may have limited availability."
    },
    "autoscaling": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["autoscaling-export.py"],
      "notes": "Fully supported"
    },
    "ecs": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["ecs-export.py"],
      "notes": "Fully supported including Fargate"
    },
    "eks": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["eks-export.py"],
      "notes": "Fully supported including EKS Auto Mode (as of 2025)"
    },
    "elasticbeanstalk": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["elasticbeanstalk-export.py"],
      "notes": "Fully supported"
    },
    "lambda": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["lambda-export.py"],
      "notes": "Fully supported including code signing"
    },
    "s3": {
      "govcloud_status": "available_with_limitations",
      "required": true,
      "export_scripts": ["s3-export.py", "s3-accesspoints-export.py"],
      "notes": "Core functionality available. S3 Transfer Acceleration, Storage Lens, Express One Zone, and some advanced features not available."
    },
    "glacier": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["glacier-export.py"],
      "notes": "Fully supported"
    },
    "elasticfilesystem": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["efs-export.py"],
      "notes": "Fully supported (referred to as 'efs' in policy)"
    },
    "fsx": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["fsx-export.py"],
      "notes": "Fully supported"
    },
    "backup": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["backup-export.py"],
      "notes": "Fully supported"
    },
    "storagegateway": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["storagegateway-export.py"],
      "notes": "Fully supported"
    },
    "rds": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["rds-export.py", "documentdb-export.py", "neptune-export.py"],
      "notes": "Fully supported including Aurora, DocumentDB, Neptune. FIPS 140-3 validated modules available."
    },
    "dynamodb": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["dynamodb-export.py"],
      "notes": "Fully supported"
    },
    "elasticache": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["elasticache-export.py"],
      "notes": "Fully supported"
    },
    "redshift": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["redshift-export.py"],
      "notes": "Fully supported"
    },
    "memorydb": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": [],
      "notes": "Fully supported"
    },
    "elasticloadbalancing": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["elb-export.py"],
      "notes": "Fully supported (ALB, NLB, CLB, GLB)"
    },
    "route53": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["route53-export.py"],
      "notes": "Fully supported"
    },
    "route53resolver": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": [],
      "notes": "Fully supported"
    },
    "cloudfront": {
      "govcloud_status": "not_in_region_usable_externally",
      "required": false,
      "export_scripts": ["cloudfront-export.py"],
      "notes": "NOT in GovCloud regions but can be used with GovCloud origins. Outside ITAR boundary. Status: Being Planned."
    },
    "directconnect": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["directconnect-export.py"],
      "notes": "Fully supported"
    },
    "globalaccelerator": {
      "govcloud_status": "not_available",
      "required": false,
      "export_scripts": ["globalaccelerator-export.py"],
      "notes": "NOT available in GovCloud. Not expanding to GovCloud. Use Route53 as alternative."
    },
    "networkmanager": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["network-manager-export.py"],
      "notes": "Fully supported including Cloud WAN (as of 2025)"
    },
    "network-firewall": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["network-firewall-export.py"],
      "notes": "Fully supported"
    },
    "iam": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["iam-export.py", "iam-roles-export.py", "iam-policies-export.py", "iam-comprehensive-export.py", "iam-identity-center-export.py", "iam-identity-center-groups-export.py", "iam-identity-center-comprehensive-export.py", "iam-identity-center-permission-sets-export.py", "iam-identity-providers-export.py", "iam-rolesanywhere-export.py"],
      "notes": "Fully supported including IAM Identity Center (AWS SSO)"
    },
    "sts": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": [],
      "notes": "Fully supported"
    },
    "kms": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["kms-export.py"],
      "notes": "Fully supported with FIPS 140-3 approved cryptographic modules"
    },
    "secretsmanager": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["secrets-manager-export.py"],
      "notes": "Fully supported"
    },
    "acm": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["acm-export.py"],
      "notes": "Fully supported"
    },
    "acm-pca": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["acm-privateca-export.py"],
      "notes": "Fully supported"
    },
    "wafv2": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["waf-export.py"],
      "notes": "Fully supported"
    },
    "shield": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["shield-export.py"],
      "notes": "Fully supported"
    },
    "guardduty": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["guardduty-export.py"],
      "notes": "Fully supported including RDS Protection, Malware Protection for EC2 and S3, Runtime Monitoring, and Extended Threat Detection"
    },
    "cloudtrail": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["cloudtrail-export.py"],
      "notes": "Fully supported. Auto-enabled for accounts created after Dec 15, 2014. CloudTrail enriched events not supported."
    },
    "config": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["config-export.py"],
      "notes": "Fully supported"
    },
    "access-analyzer": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["access-analyzer-export.py"],
      "notes": "Fully supported"
    },
    "detective": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["detective-export.py"],
      "notes": "Fully supported"
    },
    "macie2": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["macie-export.py"],
      "notes": "Fully supported (referred to as 'macie2' in API)"
    },
    "cloudwatch": {
      "govcloud_status": "available_with_limitations",
      "required": true,
      "export_scripts": ["cloudwatch-export.py"],
      "notes": "Core functionality available. Transaction Search, GetMetricWidgetImage API, dashboard sharing, and cross-account observability not available."
    },
    "logs": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": [],
      "notes": "Fully supported (CloudWatch Logs)"
    },
    "xray": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["xray-export.py"],
      "notes": "Fully supported"
    },
    "apigateway": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": [],
      "notes": "Fully supported"
    },
    "appsync": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["appsync-export.py"],
      "notes": "Fully supported"
    },
    "apprunner": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["apprunner-export.py"],
      "notes": "Fully supported"
    },
    "cognito-idp": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["cognito-export.py"],
      "notes": "Fully supported (Cognito User Pools)"
    },
    "cognito-identity": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["cognito-export.py"],
      "notes": "Fully supported (Cognito Identity Pools)"
    },
    "sns": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["sqs-sns-export.py"],
      "notes": "Fully supported"
    },
    "sqs": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["sqs-sns-export.py"],
      "notes": "Fully supported"
    },
    "events": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["eventbridge-export.py"],
      "notes": "Fully supported (EventBridge)"
    },
    "states": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["stepfunctions-export.py"],
      "notes": "Fully supported (Step Functions)"
    },
    "codecommit": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["codecommit-export.py"],
      "notes": "Fully supported"
    },
    "codebuild": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["codebuild-export.py"],
      "notes": "Fully supported"
    },
    "codedeploy": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["codedeploy-export.py"],
      "notes": "Fully supported"
    },
    "codepipeline": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["codepipeline-export.py"],
      "notes": "Fully supported"
    },
    "glue": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["glue-athena-export.py"],
      "notes": "Fully supported"
    },
    "athena": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["glue-athena-export.py"],
      "notes": "Fully supported"
    },
    "lakeformation": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["lakeformation-export.py"],
      "notes": "Fully supported"
    },
    "es": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": [],
      "notes": "Fully supported (OpenSearch Service, formerly Elasticsearch)"
    },
    "sagemaker": {
      "govcloud_status": "available",
      "required": false,
      "export_scripts": ["sagemaker-export.py"],
      "notes": "Fully supported including JumpStart"
    },
    "bedrock": {
      "govcloud_status": "available",
      "required": false,
      "export_scripts": ["bedrock-export.py"],
      "notes": "Available as of Nov 2024 in GovCloud US-East and US-West. FedRAMP High and DoD IL-4/5 authorized. Includes Claude, Llama, Titan models."
    },
    "comprehend": {
      "govcloud_status": "available",
      "required": false,
      "export_scripts": ["comprehend-export.py"],
      "notes": "Fully supported including Comprehend Medical"
    },
    "rekognition": {
      "govcloud_status": "available",
      "required": false,
      "export_scripts": ["rekognition-export.py"],
      "notes": "Fully supported"
    },
    "cloudformation": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["cloudformation-export.py"],
      "notes": "Fully supported"
    },
    "ssm": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["ssm-fleet-export.py"],
      "notes": "Fully supported (Systems Manager)"
    },
    "servicecatalog": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["service-catalog-export.py"],
      "notes": "Fully supported"
    },
    "servicediscovery": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["servicediscovery-export.py"],
      "notes": "Fully supported (Cloud Map)"
    },
    "imagebuilder": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["image-builder-export.py"],
      "notes": "Fully supported (EC2 Image Builder)"
    },
    "datasync": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["datasync-export.py"],
      "notes": "Fully supported"
    },
    "transfer": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["transfer-family-export.py"],
      "notes": "Fully supported (Transfer Family)"
    },
    "connect": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["connect-export.py"],
      "notes": "Fully supported"
    },
    "ses": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["ses-pinpoint-export.py"],
      "notes": "Fully supported"
    },
    "mobiletargeting": {
      "govcloud_status": "available",
      "required": false,
      "export_scripts": ["ses-pinpoint-export.py"],
      "notes": "Fully supported (Pinpoint)"
    },
    "license-manager": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["license-manager-export.py"],
      "notes": "Fully supported"
    },
    "aws-marketplace": {
      "govcloud_status": "available_with_limitations",
      "required": false,
      "export_scripts": ["marketplace-export.py"],
      "notes": "Available but with limited catalog. Container and ML products not supported. Cannot launch from website."
    },
    "organizations": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["organizations-export.py"],
      "notes": "Fully supported"
    },
    "verifiedpermissions": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["verifiedpermissions-export.py"],
      "notes": "Fully supported"
    },
    "rolesanywhere": {
      "govcloud_status": "available",
      "required": true,
      "export_scripts": ["iam-rolesanywhere-export.py"],
      "notes": "Fully supported (IAM Roles Anywhere)"
    }
  },

  "recommendations": {
    "policy_split_approach": "All services in the current StratusScan IAM policy are available in GovCloud (US) with the exception of Global Accelerator. CloudFront can be used but operates outside GovCloud boundaries.",
    "govcloud_policy_changes": [
      "Remove globalaccelerator permissions entirely (service not available in GovCloud)",
      "Consider removing cloudfront permissions if ITAR compliance requires all operations within GovCloud boundary",
      "No other changes needed - all other services are fully available in GovCloud"
    ],
    "feature_limitations_to_document": [
      "S3: No Transfer Acceleration, Storage Lens, Express One Zone, or MFA Delete",
      "CloudWatch: No Transaction Search, dashboard sharing, or cross-account observability",
      "AWS Marketplace: Limited catalog, no container or ML products",
      "Trusted Advisor: Limited checks compared to commercial regions"
    ],
    "compliance_notes": [
      "All GovCloud services support FedRAMP High baseline",
      "Many services have DoD SRG Impact Level 5 authorization",
      "FIPS 140-3 approved cryptographic modules available for all service endpoints",
      "CloudFront operates outside ITAR boundary - avoid for export-controlled data",
      "Global Accelerator not available - use Route53 latency-based routing instead"
    ]
  },

  "summary": {
    "total_services_in_policy": 62,
    "available_in_govcloud": 60,
    "limited_in_govcloud": 6,
    "unavailable_in_govcloud": 1,
    "required_for_stratusscan": 55,
    "optional_for_stratusscan": 7,
    "govcloud_compatibility_percentage": 96.8
  }
}
